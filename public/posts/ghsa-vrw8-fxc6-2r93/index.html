<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="">
<meta name="description"
    content="GHSA-vrw8-fxc6-2r93 is a Host Header Injection issue in the chi framework which allows arbitrary redirect to any domain while redirecting slashes. I did not receive a CVE for this finding &ldquo;Given the lower impact (can&rsquo;t be exploited in browser or email client)&rdquo; (verbatim from the maintainers) - which I can agree with to some extent. I will say though, that lower impact vulnerabilities should also get CVEs, else there would be no CVSS &ldquo;low&rdquo; score CVEs. My slight disagreement is probably more influenced by me wanting CVEs to my name than a technical outlook. Having said that, GHSAs are pretty recognized too, and in these parts, we take what we get.
" />
<meta name="keywords"
    content="homepage, blog, go, cve-analysis" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="http://localhost:1313/posts/ghsa-vrw8-fxc6-2r93/" />


<title>
    
    I Ran Free SAST Tools on chi and Found a GHSA :: Bayesian Blogs 
    
</title>





  <link rel="stylesheet" href="/main.min.3fbdd467156edb5ed861aa27faeb89d1145b4287f0e6f84613c0311da271fd37.css" integrity="sha256-P73UZxVu217YYaon&#43;uuJ0RRbQofw5vhGE8AxHaJx/Tc=" crossorigin="anonymous">





    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">



  <meta itemprop="name" content="I Ran Free SAST Tools on chi and Found a GHSA">
  <meta itemprop="description" content="GHSA-vrw8-fxc6-2r93 is a Host Header Injection issue in the chi framework which allows arbitrary redirect to any domain while redirecting slashes. I did not receive a CVE for this finding “Given the lower impact (can’t be exploited in browser or email client)” (verbatim from the maintainers) - which I can agree with to some extent. I will say though, that lower impact vulnerabilities should also get CVEs, else there would be no CVSS “low” score CVEs. My slight disagreement is probably more influenced by me wanting CVEs to my name than a technical outlook. Having said that, GHSAs are pretty recognized too, and in these parts, we take what we get.">
  <meta itemprop="datePublished" content="2025-06-29T09:11:02-07:00">
  <meta itemprop="dateModified" content="2025-06-29T09:11:02-07:00">
  <meta itemprop="wordCount" content="1084">
  <meta itemprop="image" content="http://localhost:1313/">
  <meta itemprop="keywords" content="Go,Cve-Analysis">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/">
  <meta name="twitter:title" content="I Ran Free SAST Tools on chi and Found a GHSA">
  <meta name="twitter:description" content="GHSA-vrw8-fxc6-2r93 is a Host Header Injection issue in the chi framework which allows arbitrary redirect to any domain while redirecting slashes. I did not receive a CVE for this finding “Given the lower impact (can’t be exploited in browser or email client)” (verbatim from the maintainers) - which I can agree with to some extent. I will say though, that lower impact vulnerabilities should also get CVEs, else there would be no CVSS “low” score CVEs. My slight disagreement is probably more influenced by me wanting CVEs to my name than a technical outlook. Having said that, GHSAs are pretty recognized too, and in these parts, we take what we get.">



<meta property="og:url" content="http://localhost:1313/posts/ghsa-vrw8-fxc6-2r93/">
  <meta property="og:site_name" content="Bayesian Blogs">
  <meta property="og:title" content="I Ran Free SAST Tools on chi and Found a GHSA">
  <meta property="og:description" content="GHSA-vrw8-fxc6-2r93 is a Host Header Injection issue in the chi framework which allows arbitrary redirect to any domain while redirecting slashes. I did not receive a CVE for this finding “Given the lower impact (can’t be exploited in browser or email client)” (verbatim from the maintainers) - which I can agree with to some extent. I will say though, that lower impact vulnerabilities should also get CVEs, else there would be no CVSS “low” score CVEs. My slight disagreement is probably more influenced by me wanting CVEs to my name than a technical outlook. Having said that, GHSAs are pretty recognized too, and in these parts, we take what we get.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-06-29T09:11:02-07:00">
    <meta property="article:modified_time" content="2025-06-29T09:11:02-07:00">
    <meta property="article:tag" content="Go">
    <meta property="article:tag" content="Cve-Analysis">
    <meta property="og:image" content="http://localhost:1313/">






<meta property="article:published_time" content="2025-06-29 09:11:02 -0700 PDT" />










    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text ">
                cd /home</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about">About</a></li><li><a href="/posts">Blog</a></li><li><a href="/cocktails">Cocktails</a></li><li><a href="/pgp">PGP</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
<main class="post">

  <div class="post-info">
    <p>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
        class="feather feather-clock">
        <circle cx="12" cy="12" r="10"></circle>
        <polyline points="12 6 12 12 16 14"></polyline>
      </svg>
      6 minutes

      
    </p>
  </div>

  <article>
    <h1 class="post-title">
      <a href="http://localhost:1313/posts/ghsa-vrw8-fxc6-2r93/">I Ran Free SAST Tools on chi and Found a GHSA</a>
    </h1>

    

    
    <hr />
    <aside id="toc">
      <div class="toc-title">Table of Contents</div>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#about-chi">About chi</a>
      <ul>
        <li><a href="#chi-middleware">Chi Middleware</a></li>
        <li><a href="#redirect-slashes-middleware">Redirect Slashes Middleware</a></li>
      </ul>
    </li>
    <li><a href="#ghsa-vrw8-fxc6-2r93">GHSA-vrw8-fxc6-2r93</a>
      <ul>
        <li><a href="#summary">Summary</a></li>
        <li><a href="#details">Details</a></li>
        <li><a href="#poc">PoC</a></li>
        <li><a href="#impact">Impact</a></li>
        <li><a href="#cvss-score">CVSS score</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#timeline">Timeline</a></li>
  </ul>
</nav>
    </aside>
    <hr />

    

    <div class="post-content">
        <p><a href="https://github.com/go-chi/chi/security/advisories/GHSA-vrw8-fxc6-2r93">GHSA-vrw8-fxc6-2r93</a> is a Host Header Injection issue in the <a href="https://github.com/go-chi/chi">chi framework</a> which allows arbitrary redirect to any domain while redirecting slashes. I did not receive a CVE for this finding &ldquo;Given the lower impact (can&rsquo;t be exploited in browser or email client)&rdquo; (verbatim from the maintainers) - which I can agree with to some extent. I will say though, that lower impact vulnerabilities should also get CVEs, else there would be no CVSS &ldquo;low&rdquo; score CVEs. My slight disagreement is probably more influenced by me wanting CVEs to my name than a technical outlook. Having said that, GHSAs are pretty recognized too, and in these parts, we take what we get.</p>
<p>This is somewhat a part 2 of my <a href="https://baishya.xyz/posts/cve-2025-30161/">previous blog</a> about using free SAST tools to find CVEs. I was particularly attracted to looking at go codebases (although my go skills are questionable at best) due to the large number of go vulnerabilities I have assessed for various reasons at work. The workflow is basically the same as described in the previous blog - so I will skip the details here. TL;DR: clone repo, run semgrep, profit $$$ (?)</p>
<h2 id="about-chi">About chi</h2>
<p>From the README:</p>
<blockquote>
<p>chi is a lightweight, idiomatic and composable router for building Go HTTP services. It&rsquo;s especially good at helping you write large REST API services that are kept maintainable as your project grows and changes. chi is built on the new context package introduced in Go 1.7 to handle signaling, cancelation and request-scoped values across a handler chain.</p></blockquote>
<h3 id="chi-middleware">Chi Middleware</h3>
<p>One of chi&rsquo;s powerful features is middleware—modular functions that sit between the incoming request and your handlers. Middleware in Chi allows you to add cross-cutting behavior like logging, authentication, rate limiting, or CORS handling in a clean and reusable way. Middleware functions wrap around routes or groups of routes, making them easy to apply globally or selectively. This modularity helps keep your codebase maintainable and your concerns separated.</p>
<p>This is very similar to other popular frameworks such as Express, next.js or Django.</p>
<h3 id="redirect-slashes-middleware">Redirect Slashes Middleware</h3>
<p>The RedirectSlashes middleware in the Chi router is a built-in middleware that automatically normalizes request URLs by handling trailing slashes. It ensures consistent routing behavior and helps avoid issues where <code>/foo</code> and <code>/foo/</code> are treated as different routes.</p>
<h2 id="ghsa-vrw8-fxc6-2r93">GHSA-vrw8-fxc6-2r93</h2>
<p>I am feeling lazy, and there is no mind-bending state-of-the-art exploitation technique here, so I&rsquo;ll just append the report I sent to the maintainers. (With the original <code>RedirectSlashes</code> function added in since the original code has been fixed. The maintainers also added a note which has been highlighted.)</p>
<h3 id="summary">Summary</h3>
<p>The <code>RedirectSlashes</code> function in <code>middleware/strip.go</code> is vulnerable to host header injection which leads to open redirect.</p>
<p>We consider this a <strong>lower-severity</strong> open redirect, as it can&rsquo;t be exploited from browsers or email clients (requires manipulation of a Host header). [Added by maintainers]</p>
<h3 id="details">Details</h3>
<p>The <code>RedirectSlashes</code> method uses the Host header to construct the redirectURL</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">RedirectSlashes</span>(<span style="color:#a6e22e">next</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handler</span>) <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handler</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">fn</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">path</span> <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">rctx</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">chi</span>.<span style="color:#a6e22e">RouteContext</span>(<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Context</span>())
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">rctx</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">rctx</span>.<span style="color:#a6e22e">RoutePath</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;&#34;</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">path</span> = <span style="color:#a6e22e">rctx</span>.<span style="color:#a6e22e">RoutePath</span>
</span></span><span style="display:flex;"><span>		} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">path</span> = <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">URL</span>.<span style="color:#a6e22e">Path</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> len(<span style="color:#a6e22e">path</span>) &gt; <span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">path</span>[len(<span style="color:#a6e22e">path</span>)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;/&#39;</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">URL</span>.<span style="color:#a6e22e">RawQuery</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;&#34;</span> {
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">path</span> = <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">&#34;%s?%s&#34;</span>, <span style="color:#a6e22e">path</span>[:len(<span style="color:#a6e22e">path</span>)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>], <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">URL</span>.<span style="color:#a6e22e">RawQuery</span>)
</span></span><span style="display:flex;"><span>			} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">path</span> = <span style="color:#a6e22e">path</span>[:len(<span style="color:#a6e22e">path</span>)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Host header used to create redirect URL here</span>
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">redirectURL</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">&#34;//%s%s&#34;</span>, <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Host</span>, <span style="color:#a6e22e">path</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Redirect</span>(<span style="color:#a6e22e">w</span>, <span style="color:#a6e22e">r</span>, <span style="color:#a6e22e">redirectURL</span>, <span style="color:#ae81ff">301</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">next</span>.<span style="color:#a6e22e">ServeHTTP</span>(<span style="color:#a6e22e">w</span>, <span style="color:#a6e22e">r</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HandlerFunc</span>(<span style="color:#a6e22e">fn</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The Host header can be manipulated by a user to be any arbitrary host. This leads to open redirect when using the <code>RedirectSlashes</code> middleware</p>
<h3 id="poc">PoC</h3>
<p>Create a simple server which uses the <code>RedirectSlashes</code> middleware</p>
<pre tabindex="0"><code>package main

import (
	&#34;fmt&#34;
	&#34;net/http&#34;

	&#34;github.com/go-chi/chi/v5&#34;
	&#34;github.com/go-chi/chi/v5/middleware&#34; // Import the middleware package
)

func main() {
	// Create a new Chi router
	r := chi.NewRouter()

	// Use the built-in RedirectSlashes middleware
	r.Use(middleware.RedirectSlashes) // Use middleware.RedirectSlashes

	// Define a route handler
	r.Get(&#34;/&#34;, func(w http.ResponseWriter, r *http.Request) {
		// A simple response
		w.Write([]byte(&#34;Hello, World!&#34;))
	})

	// Start the server
	fmt.Println(&#34;Starting server on :8080&#34;)
	http.ListenAndServe(&#34;:8080&#34;, r)
}
</code></pre><p>Run the server <code>go run main.go</code></p>
<p>Once the server is running, send a request that will trigger the <code>RedirectSlashes</code> function with an arbitrary Host header
<code>curl -iL -H &quot;Host: example.com&quot; http://localhost:8080/test/</code></p>
<p>Observe that the request will be redirected to example.com</p>
<pre tabindex="0"><code>curl -L -H &#34;Host: example.com&#34; http://localhost:8080/test/

&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Example Domain&lt;/title&gt;

    &lt;meta charset=&#34;utf-8&#34; /&gt;
    &lt;meta http-equiv=&#34;Content-type&#34; content=&#34;text/html; charset=utf-8&#34; /&gt;
    &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1&#34; /&gt;
    &lt;style type=&#34;text/css&#34;&gt;
    body {
        background-color: #f0f0f2;
        margin: 0;
        padding: 0;
        font-family: -apple-system, system-ui, BlinkMacSystemFont, &#34;Segoe UI&#34;, &#34;Open Sans&#34;, &#34;Helvetica Neue&#34;, Helvetica, Arial, sans-serif;
... snipped ...
</code></pre><p>Without the host header, the response is returned from the test server</p>
<pre tabindex="0"><code>curl -L http://localhost:8080/test/

404 page not found
</code></pre><h3 id="impact">Impact</h3>
<p>An open redirect vulnerability allows attackers to trick users into visiting malicious sites. This can lead to phishing attacks, credential theft, and malware distribution, as users trust the application’s domain while being redirected to harmful sites.</p>
<h3 id="cvss-score">CVSS score</h3>
<p>I had originally scored this CVE as a Medium severity CVE with a score of 5.1 (CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:A/VC:L/VI:L/VA:N/SC:N/SI:N/SA:N). This is the current score in the advisory.</p>
<p>Reflecting back, it can be argued that the score is 2.1 Low (CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:A/VC:L/VI:L/VA:N/SC:N/SI:N/SA:N)</p>
<h2 id="conclusion">Conclusion</h2>
<p>This is another win for my free SAST tools experiment. FWIW, this is also the first security advisory published for <code>chi</code>. I am not entirely sure if this is the first vulnerability discovered in <code>chi</code>. I did try looking for CVEs but I did not find any - so I would like to believe this is the first.</p>
<p>Sneak peek into my fuzzing escapades - I gave up on fuzzing using AFL++ on popular C/C++ codebases - due to many skill issues. I prefer spending my time away from work doing non-security things (which is probably obvious given the inconsistent post history here and the basic content of the few blogs that are posted). Therefore I determined that I don&rsquo;t want to spend the time needed to dive into the completely unchartered territory of fuzzing C / C++ binaries. I did however find that go code can be fuzzed too - and that had a easier entry point for me personally. So, I pivoted to fuzzing go code instead. Did I find something? 🤷. Thank you for reading.</p>
<h2 id="timeline">Timeline</h2>
<ul>
<li>March 5, 2025: Reported issue to chi maintainers through Github.</li>
<li>June 6, 2025: Commented on report due to no response from chi maintainers. Received acknowledgement of report receipt.</li>
<li>June 9, 2025: chi maintainers confirmed the issue.</li>
<li>June 19, 2025: Fix released, GHSA published.</li>
<li>June 29, 2025: Blog published.</li>
</ul>

    </div>

    
  </div>

  
    <div class="pagination">
        

        <div class="pagination__buttons">
            

            
            <span class="button next">
                <a href="http://localhost:1313/posts/cve-2025-30161/">
                    <span class="button__text">I Ran Free SAST Tools on OpenEMR and Found a CVE</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>


  

  

</main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2025</span>
            
            
            
            <span>Anuraag Baishya</span>
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a> & <a href="https://github.com/rhazdon/hugo-theme-hello-friend-ng">Hello Friend NG</a> theme</span>
        </div>
    </div>
    
</footer>

            
        </div>

        


<script type="text/javascript" src="/bundle.min.4037dc94fd1565c4fd3354e2b4a2d1ff11842c906242435350b4d2d8d6e8b7890da46c0a865173f543a6161c1f4d1c94147f1b907db36489fc2bf5e20d4af75c.js" integrity="sha512-QDfclP0VZcT9M1TitKLR/xGELJBiQkNTULTS2Nbot4kNpGwKhlFz9UOmFhwfTRyUFH8bkH2zZIn8K/XiDUr3XA=="></script>




    </body>
</html>
